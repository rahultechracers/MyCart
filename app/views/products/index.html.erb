<h1>Listing products</h1>

<div>
  <h4>Select Category:</h4>
  <select name="category_id">
    <option value="all"> All</option>
    <%= @categories.each do |category| %>
        <option value="<%= category.id %>"><%= category.name %>      </option>
    <% end %>
  </select>
</div>

<table>
  <thead>
    <tr>
      <th> Name</th>
      <th>Description</th>
      <th>Image url</th>
      <th>Price</th>
      
    </tr>
  </thead>

  <tbody>
    <% @products.each do |product| %>
      <tr>
        <td><%= product.name %></td>
        <td><%= product.description %></td>
        <td><%= product.image_url %></td>
        <td><%= product.price %></td>
        <%if current_user.present? %>
          <td><%= button_to 'Add to Cart', cart_details_path(product_id: product,cart_id: @cart.first.id) %><td>
        <%else%>
          <td><%= button_to 'Add to Cart', log_in_path, method: :get  %><td>
             <%flash[:notice] = "please Login First to save your cart details"%>
        <%end%>

        <td><%= link_to 'Show', product %></td>
        <% if current_user.present?&& current_user.role="admin"%>
        <td><%= link_to 'Edit', edit_product_path(product) %></td>
        <td><%= link_to 'Destroy', product, method: :delete %><td>
          <%end%>
      </tr>
    <% end %>
  </tbody>
</table>

<br>
<% if current_user.present?&& current_user.role="admin"%>
<%= link_to 'New Product', new_product_path %>
 <%end%>